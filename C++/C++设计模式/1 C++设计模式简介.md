# 1 C++设计模式

- 理解松耦合设计思想
- 掌握面向对象设计原则
- 掌握重构技法改善设计
- 掌握GOF 核心设计模式

## 什么是设计模式

> “每一个模式描述了一个在我们周围不断重复发生的问题以及该问题的解决方案的核心。这样，你就能一次又一次地使用该方案而不必做重复劳动”。

## 从面向对象谈起

### 思维

| 思维方式 | 作用                           | 内容                                   |
| -------- | ------------------------------ | -------------------------------------- |
| 底层思维 | 向下，把握机器底层微观构造     | 语言构造、编译转换、内存模型、运行机制 |
| 抽象思维 | 向上，将现实世界抽象为程序代码 | 面向对象、组件封装、设计模式、架构模式 |

### 深入面向对象

向下：深入理解面向对象三大机制

- 封装 — 隐藏内部代码
- 继承 — 复用已有代码
- 多态 — 改写对象行为

向上：深刻把握面向对象机制所带来的抽象意义

### 软件设计固有的复杂性

> 建筑商从来不会去想给一栋已建好的100层高的楼房底下再新修一个小地下室——这样做花费极大而且注定要失败。然而令人惊奇的是，软件系统的用户在要求作出类似改变时却不会仔细考虑，而且他们认为这只是需要简单编程的事。
> 																	——Object-Oriented Analysis and Design with Applications



**根本原因：变化**

#### 解决复杂性

- 分解 ： 分而治之，大问题分解为多个小问题，复杂问题分解为多个简单问题(独立实现每个小类，分别实现相应的功能)

- 抽象 —：由于不能掌握全部复杂对象，选择忽视一些非本质的细节。而去处理泛化和理想化的对象模型。（抽象一个虚基类，每个具体小类继承并重写）



#### 软件设计的目标

**复用**！





## GOF-23 模式分类

### 目的

- 创建型 — 对象创建
- 结构型 — 对象需求变化对结构造成的冲击
- 行为型 — 多个类交互

### 实现范围

- 类模式 — 处理类与子类的静态关系（继承）
- 对象模式 — 对象间的动态关系（组合）

### 从封装变化角度对模式分类

- 组件协作 — Template Method、Strategy、Observer/Event
- 单一职责 — Decorator、Bridge
- 对象创建 — Factory Method、Abstract Factory、Prototype、Builder
- 对象性能 — Singleton、Flyweight
- 接口隔离 — Facade、Proxy、Mediator、Adapter
- 状态变化 — Memento、State
- 数据结构 — Composite、Iterator、Chain of Resposibility
- 行为变化 — Command、Visitor
- 领域问题 — Interpreter
  

## 重构获得模式 `Refactoring to Patterns`

重构获得模式是普遍认为最好的使用设计模式方法

- 面向对象设计模式可以应对变化、提高复用。

- 现代软件设计特征 — 需求频繁变化。

- 设计模式的要点 — 寻找变化点（将稳定部分和变化不分分离开），变化点处使用设计模式来应对变化。

  > ”什么时候什么地点使用设计模式“可能比”理解设计模式本身更重要 “

- 设计模式的应用不该先入为主（防止误用）。没有一步到位的设计模式。（故，要Refactoring to Patterns）
  

### 重构关键技法

- 静态绑定 ==>动态绑定
- 早绑定 ==> 晚绑定
- 继承 ==> 组合
- 编译时依赖 ==> 运行时依赖
- 紧耦合 ==> 松耦合
  
