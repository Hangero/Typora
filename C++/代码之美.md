# 代码之美





## 不嵌套主义者

> Flat is better than nested.

> If you need more than 3 levels of indentation,you're screwed anyway, and should fix your program.

### 提炼

```cpp
int calculate(int bottom,int top)
{
	if (top > bottom)
    {
		int sum =0;
		for (int number bottom;number <top;number++) {
			if (number 2 ==0){
                sum +number;
            }
        }
		return sum;
	}
	else
	{
		return 0;
	}
}
```





```cpp
int filterNumber(int number){

	if (number 2 ==0){
        sum +number;
    }
    return 0;
}


int calculate(int bottom,int top)
{
	if (top > bottom)
    {
		int sum =0;
		for (int number bottom;number <top;number++) {
			sum += filterNumber(number);
        }
		return sum;
	}
	else
	{
		return 0;
	}
}
```



### 反转

反转条件，把负面分支方前面， 使函数尽早返回

```cpp
int filterNumber(int number){

	if (number 2 ==0){
        sum +number;
    }
    return 0;
}


int calculate(int bottom,int top)
{
	if (top < bottom)
	{
		return 0;
	}
	int sum =0;
	for (int number bottom;number <top;number++) {
		sum += filterNumber(number);
    }
	return sum;
	
}
```



如果有大量的条件检查，我们将使用验证保护（validation gatekeeping）

```cpp
void registerUser(String user){
    String[]parts user.split(":")
	if (parts.length =2){
        int userId Integer.parseInt(parts[]);
        if (userId >0){
            String userName parts[1];
            if (users.containsKey(userId))
			{
				users.get(userId).setName(userName);
            }
			else{
                users.put(userId,new User(userName));
            }
        }
        else{
            throw new IllegalArgumentException("Invalid user id:"userId);
        }
    }
    else
    throw new IllegalArgumentException("Invalid user string:"user);     
}

```

就像是声明了函数的要求

```cpp
void registerUser(String user){
    String[]parts user.split(":")
	if (parts.length !=2){
      throw new IllegalArgumentException("Invalid user string:"user);     
    }
    
    int userId Integer.parseInt(parts[]);
    if (userId < 0){
     throw new IllegalArgumentException("Invalid user id:"userId);
    }
    
    //可以专注于代码主体而忽略条件
    String userName parts[1];
	if (users.containsKey(userId))
	{
	users.get(userId).setName(userName);
    }
	else{
	users.put(userId,new User(userName));
	}
    
}
```

