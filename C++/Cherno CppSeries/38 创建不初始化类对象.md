# 38 创建并初始化类对象

创建类有两种选择，区别是：内存从哪里来，在哪创建对象

应用程序中会将内存主要分为两部分：堆和栈

栈对象，会有一个自动生存周期

### 栈分配

格式:

```cpp
// 栈中创建
Entity entity;
Entity entity("lk");
```

- 什么时候栈分配？几乎任何时候，因为在C++中这是初始化对象最快的方式和最受管控的方式。
- 什么时候不栈分配？ 如果创建的**对象太大**，或是需要显示地控制对象的**生存期**，那就需要堆上创建 。

```cpp
void Function{
    Entity entity = Entity("Cherno");
}
```

- 一旦我们到达这个花括号，这个entity会从内存中被销毁，因为我们调用最高函数时，就为这个函数创建了一个栈结构，它包含了我们声明的所有局部变量。

### 堆分配

格式:

```cpp
// 堆中创建
Entity* entity = new Entity("lk");
delete entity； //清除
```

- 想将变量在作用域外依然存在，就要分配到栈上；或者规模太大，没有足够的空间在栈上分配（因为栈通常非常小）
- 当我们调用new Entity时，实际发生的就是我们在堆上分配了内存，我们调用了构造函数，然后这个new Entity实际上会返回一个Entity指针，它返回了这个entity在堆上被分配的内存地址，这就是为什么我们要声明成Entity*类型。
- 如果你使用了new关键字，那你就要用delete来进行释放内存；如果不进行，会导致内存泄漏。当然，记住确实不容易，**可以使用智能指针**